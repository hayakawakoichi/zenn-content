---
title: "Node.js ç’°å¢ƒå¤‰æ•°ç®¡ç†ã®æ”¹å–„: dotenv ã‹ã‚‰ --env-file ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¸å¤‰æ›´ã™ã‚‹éš›ã®æ³¨æ„ç‚¹"
emoji: "ðŸ•"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nodejs", "ç’°å¢ƒå¤‰æ•°", "dotenv"]
published: true
---

## ã¯ã˜ã‚ã«

Node.js ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã«ä¼´ã†ç’°å¢ƒå¤‰æ•°ã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦ã€å®Ÿéš›ã«é­é‡ã—ãŸèª²é¡Œã¨è§£æ±ºç­–ã‚’å…±æœ‰ã—ã¾ã™ã€‚

## èƒŒæ™¯

ç§ãŒæ‰€å±žã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€æœ€è¿‘ Node.js ã‚’æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆv22ï¼‰ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã—ãŸã€‚
ã“ã®éš›ã€ã“ã‚Œã¾ã§ç’°å¢ƒå¤‰æ•°ã®èª­ã¿è¾¼ã¿ã«ä½¿ç”¨ã—ã¦ã„ãŸ `dotenv` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆãŠã‚ˆã³ `dotenv -e` ã‚³ãƒžãƒ³ãƒ‰ï¼‰ã‚’ã€Node.js çµ„ã¿è¾¼ã¿ã® `--env-file` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚
`--env-file` ã¯ã€Node.js 20.6.0 ä»¥é™ã§åˆ©ç”¨å¯èƒ½ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€ã“ã‚Œã«ã‚ˆã‚Šå¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã›ãšã« .env ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’ç›´æŽ¥èª­ã¿è¾¼ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

å¤‰æ›´å‰å¾Œã®ã‚³ãƒ¼ãƒ‰ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

```diff
{
    "scripts": {
-       "dev": "dotenv -e .env -- node src/index.js",
+       "dev": "node --env-file=.env src/index.js",
    }
}
```

## ç›´é¢ã—ãŸèª²é¡Œ

`--env-file` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¸ã®ç§»è¡Œè‡ªä½“ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ãŒã€å®Ÿé‹ç”¨ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸéš›ã«å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚
`--env-file` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€**æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã‚‹**ã¨ã„ã†ä»•æ§˜ã«ãªã£ã¦ã„ã¾ã™ã€‚

ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†æ–¹æ³•ã¨ã—ã¦ã€ä¸‹è¨˜ã®ã‚ˆã†ãªæ§‹æˆã‚’å–ã‚‹å ´åˆã€`--env-file` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã§ã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ã‚¨ãƒ©ãƒ¼ã¨ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

1. é–‹ç™ºè€…ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ
   - `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ãã®ä¸­ã§ç’°å¢ƒå¤‰æ•°ã‚’ç®¡ç†

2. æœ¬ç•ªç’°å¢ƒï¼ˆVercel, Cloudflare Pages, etc.ï¼‰
   - `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½¿ç”¨ã›ãšã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ç®¡ç†ç”»é¢ä¸Šã§ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
   - `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `.vercelignore` ã‚„ `.gitignore` ã«å«ã‚ã¦ã„ã‚‹

## è§£æ±ºç­–: --env-file-if-exist ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ´»ç”¨

Node.js ã«ã¯ `--env-file-if-exist` ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯åå‰ãŒç¤ºã™é€šã‚Šã€**æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ãšã€å‡¦ç†ã‚’ç¶šè¡Œã™ã‚‹**ã¨ã„ã†ä»•æ§˜ã«ãªã£ã¦ã„ã¾ã™ã€‚

```json
// package.json ã®ä¾‹
{
  "scripts": {
    "dev": "node --env-file-if-exist=.env src/index.js"
  }
}
```

ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€

1. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚€
2. Vercel ãªã©ã®ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªãã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å´ã§è¨­å®šã•ã‚ŒãŸç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã™ã‚‹

ã¨ã„ã†å‹•ä½œãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚(`dotenv -e` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨åŒã˜æŒ™å‹•ã«ãªã‚Šã¾ã™)

## ã¾ã¨ã‚

Node.js ã® `--env-file` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ .env ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã¨ã‚¯ãƒ©ã‚¦ãƒ‰ã®ç’°å¢ƒã‚’è€ƒæ…®ã™ã‚‹å ´åˆã¯ `--env-file-if-exist` ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€è‰¯ã•ãã†ã§ã™ã€‚

## å‚è€ƒ

> In case you want to optionally read from a .env file, it's possible to avoid throwing an error if the file is missing using the --env-file-if-exists flag.

https://nodejs.org/en/learn/command-line/how-to-read-environment-variables-from-nodejs
